<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–∏—é—Ç –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö</title>
    <style>
        /* –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .filters-container {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .filter-section {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .filter-section h3 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 8px;
        }
        
        .filter-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            min-width: 150px;
        }
        
        label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #555;
            font-size: 14px;
        }
        
        select, input {
            padding: 8px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            background: white;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: #007bff;
        }
        
        .search-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
            transition: background 0.3s;
        }
        
        .search-btn:hover {
            background: #0056b3;
        }
        
        .animals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .animal-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .animal-card:hover {
            transform: translateY(-5px);
        }
        
        .animal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .animal-name {
            font-size: 1.4rem;
            color: #333;
            font-weight: bold;
            margin: 0;
        }
        
        .animal-type {
            background: #007bff;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            text-transform: uppercase;
        }
        
        .photos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); /* ‚Üê –í—ã—Å–æ—Ç–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ */
            gap: 10px;
        }

        .photo {
            width: 100%;
            height: 120px; /* ‚Üê –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞, –Ω–æ —à–∏—Ä–∏–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è */
            object-fit: cover;
            border-radius: 8px;
        }
        
        .animal-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }
        
        .detail-item {
            font-size: 0.9rem;
        }
        
        .detail-label {
            font-weight: bold;
            color: #666;
        }
        
        .shelter-info {
            background: #e3f2fd;
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            border-left: 4px solid #007bff;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.1rem;
            color: #666;
        }
        
        .error {
            background: #ffebee;
            color: #c62828;
            padding: 15px;
            border-radius: 6px;
            text-align: center;
            margin: 20px 0;
        }
        
        .no-results {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 1.1rem;
        }
        
        .reset-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-left: 10px;
        }
        
        .reset-btn:hover {
            background: #545b62;
        }

        /* –ù–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Å–µ–∫—Ü–∏–∏ –ø—Ä–∏—é—Ç–æ–≤ */
        .shelters-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin-top: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .shelters-section h2 {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
            border-bottom: 3px solid #28a745;
            padding-bottom: 15px;
        }
        
        .shelters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 30px;
        }
        
        .shelter-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            border-left: 5px solid #28a745;
        }
        
        .shelter-card:hover {
            transform: translateY(-3px);
        }
        
        .shelter-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .shelter-photo {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 50%;
            border: 3px solid #28a745;
        }
        
        .shelter-name {
            font-size: 1.5rem;
            color: #333;
            font-weight: bold;
            margin: 0;
        }
        
        .shelter-details {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .shelter-detail {
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }
        
        .shelter-icon {
            color: #28a745;
            font-size: 1.1rem;
            min-width: 20px;
        }
        
        .shelter-description {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-style: italic;
            border-left: 3px solid #28a745;
        }
        
        .shelter-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #dee2e6;
        }
        
        .stat-item {
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 6px;
        }
        
        .stat-number {
            font-size: 1.3rem;
            font-weight: bold;
            color: #28a745;
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üêæ –ü—Ä–∏—é—Ç –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö</h1>
        <p>–ù–∞–π–¥–∏—Ç–µ —Å–≤–æ–µ–≥–æ –Ω–æ–≤–æ–≥–æ –¥—Ä—É–≥–∞</p>
    </div>

    <div class="filters-container">
        <div class="filter-section">
            <h3>üîç –§–∏–ª—å—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</h3>
            
            <div class="filter-row">
                <div class="filter-group">
                    <label for="typeFilter">–¢–∏–ø –∂–∏–≤–æ—Ç–Ω–æ–≥–æ</label>
                    <select id="typeFilter">
                        <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                        <option value="cat">–ö–æ—à–∫–∏</option>
                        <option value="dog">–°–æ–±–∞–∫–∏</option>
                        <option value="other">–î—Ä—É–≥–∏–µ</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="shelterFilter">–ü—Ä–∏—é—Ç</label>
                    <select id="shelterFilter">
                        <option value="">–í—Å–µ –ø—Ä–∏—é—Ç—ã</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="genderFilter">–ü–æ–ª</label>
                    <select id="genderFilter">
                        <option value="">–õ—é–±–æ–π –ø–æ–ª</option>
                        <option value="male">–ú—É–∂—Å–∫–æ–π</option>
                        <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="ageFilter">–í–æ–∑—Ä–∞—Å—Ç</label>
                    <select id="ageFilter">
                        <option value="">–õ—é–±–æ–π –≤–æ–∑—Ä–∞—Å—Ç</option>
                        <option value="0-1">–î–æ 1 –≥–æ–¥–∞</option>
                        <option value="1-3">1-3 –≥–æ–¥–∞</option>
                        <option value="3-7">3-7 –ª–µ—Ç</option>
                        <option value="7+">–°—Ç–∞—Ä—à–µ 7 –ª–µ—Ç</option>
                    </select>
                </div>
            </div>
            
            <div class="filter-row">
                <div class="filter-group">
                    <label for="searchFilter">–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏</label>
                    <input type="text" id="searchFilter" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è...">
                </div>
                
                <div class="filter-group">
                    <label for="healthFilter">–°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è</label>
                    <select id="healthFilter">
                        <option value="">–õ—é–±–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</option>
                        <option value="–∑–¥–æ—Ä–æ–≤">–ó–¥–æ—Ä–æ–≤</option>
                        <option value="—Ç—Ä–µ–±—É–µ—Ç –ª–µ—á–µ–Ω–∏—è">–¢—Ä–µ–±—É–µ—Ç –ª–µ—á–µ–Ω–∏—è</option>
                        <option value="—Ö—Ä–æ–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ">–•—Ä–æ–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ</option>
                    </select>
                </div>
            </div>
            
            <button class="search-btn" onclick="filterAndDisplayAnimals()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
            <button class="reset-btn" onclick="resetFilters()">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
        </div>
    </div>

    <div id="loading" class="loading">
        –ó–∞–≥—Ä—É–∑–∫–∞ –∂–∏–≤–æ—Ç–Ω—ã—Ö...
    </div>

    <div id="error" class="error" style="display: none;">
        –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
    </div>

    <div id="animalsContainer" class="animals-grid">
        <!-- –ñ–∏–≤–æ—Ç–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
    </div>

    <!-- –ù–æ–≤–∞—è —Å–µ–∫—Ü–∏—è –ø—Ä–∏—é—Ç–æ–≤ -->
    <div class="shelters-section">
        <h2>üè† –ù–∞—à–∏ –ø—Ä–∏—é—Ç—ã</h2>
        <div id="sheltersContainer" class="shelters-grid">
            <!-- –ü—Ä–∏—é—Ç—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:4000/api';
        let allAnimals = [];
        let allShelters = [];

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            loadShelters();
            loadAnimals();
        });

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∂–∏–≤–æ—Ç–Ω—ã—Ö
        async function loadAnimals() {
            try {
                showLoading();
                
                const [animalsResponse] = await Promise.all([
                    fetch(`${API_BASE}/animals`),
                ]);

                if (!animalsResponse.ok) {
                    throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö');
                }

                allAnimals = await animalsResponse.json();
                
                updateShelterFilter();
                filterAndDisplayAnimals();
                hideLoading();
                
            } catch (error) {
                showError('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ: ' + error.message);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏—é—Ç–æ–≤
        async function loadShelters() {
            try {
                const response = await fetch(`${API_BASE}/shelters`);
                if (!response.ok) {
                    throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏—é—Ç–æ–≤');
                }
                allShelters = await response.json();
                displayShelters(allShelters);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏—é—Ç–æ–≤:', error);
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏—é—Ç–æ–≤
        function displayShelters(shelters) {
            const container = document.getElementById('sheltersContainer');
            
            if (!shelters || shelters.length === 0) {
                container.innerHTML = '<div class="no-results">üè† –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏—é—Ç–∞—Ö –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞</div>';
                return;
            }

            container.innerHTML = shelters.map(shelter => {
                // –ü–æ–¥—Å—á–µ—Ç –∂–∏–≤–æ—Ç–Ω—ã—Ö –≤ –ø—Ä–∏—é—Ç–µ
                const photoUrls = Array.isArray(shelter.photos) 
                    ? shelter.photos.map(photo => typeof photo === 'string' ? photo : photo.url)
                    : [];
                const animalsInShelter = allAnimals.filter(animal => animal.shelter_id === shelter.id);
                const catsCount = animalsInShelter.filter(animal => animal.type === 'cat').length;
                console.log(catsCount);
                const dogsCount = animalsInShelter.filter(animal => animal.type === 'dog').length;
                const otherCount = animalsInShelter.filter(animal => animal.type !== 'cat' && animal.type !== 'dog').length;
                return `
                    <div class="shelter-card">
                        <div class="shelter-header">
                             ${photoUrls.map(photoUrl => `
                            <img src="${photoUrl}" 
                                 alt="${shelter.name}" class="shelter-photo"
                                 onerror="this.src='https://via.placeholder.com/80x80/28a745/ffffff?text=üè†'">`
                             ).join('')}
                            <div>
                                <h3 class="shelter-name">${escapeHtml(shelter.name)}</h3>
                                <div style="color: #666; font-size: 0.9rem;">ID: ${shelter.id}</div>
                            </div>
                        </div>
                        
                        <div class="shelter-details">
                            ${shelter.address ? `
                                <div class="shelter-detail">
                                    <span class="shelter-icon">üìç</span>
                                    <span>${escapeHtml(shelter.address)}</span>
                                </div>
                            ` : ''}
                            
                            ${shelter.phone ? `
                                <div class="shelter-detail">
                                    <span class="shelter-icon">üìû</span>
                                    <span>${escapeHtml(shelter.phone)}</span>
                                </div>
                            ` : ''}
                            
                            ${shelter.email ? `
                                <div class="shelter-detail">
                                    <span class="shelter-icon">‚úâÔ∏è</span>
                                    <span>${escapeHtml(shelter.email)}</span>
                                </div>
                            ` : ''}
                            
                            ${shelter.working_hours ? `
                                <div class="shelter-detail">
                                    <span class="shelter-icon">üïí</span>
                                    <span>${escapeHtml(shelter.working_hours)}</span>
                                </div>
                            ` : ''}
                        </div>
                        
                        ${shelter.description ? `
                            <div class="shelter-description">
                                "${escapeHtml(shelter.description)}"
                            </div>
                        ` : ''}
                        
                       
                    </div>
                `;
            }).join('');
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –ø—Ä–∏—é—Ç–æ–≤
        function updateShelterFilter() {
            const shelterFilter = document.getElementById('shelterFilter');
            shelterFilter.innerHTML = '<option value="">–í—Å–µ –ø—Ä–∏—é—Ç—ã</option>';
            
            allShelters.forEach(shelter => {
                const option = document.createElement('option');
                option.value = shelter.id;
                option.textContent = shelter.name;
                shelterFilter.appendChild(option);
            });
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω—ã—Ö
        function filterAndDisplayAnimals() {
            const typeFilter = document.getElementById('typeFilter').value;
            const shelterFilter = document.getElementById('shelterFilter').value;
            const genderFilter = document.getElementById('genderFilter').value;
            const ageFilter = document.getElementById('ageFilter').value;
            const searchFilter = document.getElementById('searchFilter').value.toLowerCase();
            const healthFilter = document.getElementById('healthFilter').value;
            let filteredAnimals = allAnimals;
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã
            if (typeFilter) {
                if (typeFilter === 'other') {
                    filteredAnimals = filteredAnimals.filter(animal => animal.type !== 'cat' && animal.type !== 'dog');
                } else {
                    filteredAnimals = filteredAnimals.filter(animal => animal.type === typeFilter);
                }
            }
            
            if (shelterFilter) {
                console.log(shelterFilter);
                filteredAnimals = filteredAnimals.filter(animal => String(animal.shelter_id) === String(shelterFilter));
            }
            
            if (genderFilter) {
                filteredAnimals = filteredAnimals.filter(animal => animal.gender === genderFilter);
            }
            
            if (ageFilter) {
                filteredAnimals = filteredAnimals.filter(animal => {
                    const age = animal.age || 0;
                    switch(ageFilter) {
                        case '0-1': return age <= 1;
                        case '1-3': return age > 1 && age <= 3;
                        case '3-7': return age > 3 && age <= 7;
                        case '7+': return age > 7;
                        default: return true;
                    }
                });
            }
            
            if (searchFilter) {
                filteredAnimals = filteredAnimals.filter(animal => 
                    animal.name.toLowerCase().includes(searchFilter)
                );
            }
            
            if (healthFilter) {
                filteredAnimals = filteredAnimals.filter(animal => 
                    animal.health && animal.health.toLowerCase().includes(healthFilter.toLowerCase())
                );
            }
            
            displayAnimals(filteredAnimals);
        }

        // –°–±—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–æ–≤
        function resetFilters() {
            document.getElementById('typeFilter').value = '';
            document.getElementById('shelterFilter').value = '';
            document.getElementById('genderFilter').value = '';
            document.getElementById('ageFilter').value = '';
            document.getElementById('searchFilter').value = '';
            document.getElementById('healthFilter').value = '';
            filterAndDisplayAnimals();
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω—ã—Ö
        function displayAnimals(animals) {
            const container = document.getElementById('animalsContainer');
            
            if (animals.length === 0) {
                container.innerHTML = '<div class="no-results">üêæ –ñ–∏–≤–æ—Ç–Ω—ã–µ –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–∞–º –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }

            container.innerHTML = animals.map(animal => {
                const shelter = allShelters.find(s => s.id === animal.shelter_id);
                const photoUrls = Array.isArray(animal.photos) 
                    ? animal.photos.map(photo => typeof photo === 'string' ? photo : photo.url)
                    : [];

                return `
                    <div class="animal-card">
                        <div class="animal-header">
                            <div class="animal-name">${escapeHtml(animal.name)}</div>
                            <div class="animal-type">${getAnimalType(animal.type)}</div>
                        </div>
                        
                        ${photoUrls.length > 0 ? `
                            <div class="photos-grid">
                                ${photoUrls.map(photoUrl => 
                                    `<img src="${photoUrl}" alt="${animal.name}" class="photo" 
                                          onerror="this.src='https://via.placeholder.com/120x120/cccccc/969696?text=–ù–µ—Ç+—Ñ–æ—Ç–æ'">`
                                ).join('')}
                            </div>
                        ` : '<p style="text-align:center; color:#666;">üì∑ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –Ω–µ—Ç</p>'}
                        
                        <div class="animal-details">
                            <div class="detail-item">
                                <span class="detail-label">–í–æ–∑—Ä–∞—Å—Ç:</span> ${animal.age || '–ù–µ —É–∫–∞–∑–∞–Ω'} –ª–µ—Ç
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">–ü–æ–ª:</span> ${getGender(animal.gender)}
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">–û–∫—Ä–∞—Å:</span> ${animal.color || '–ù–µ —É–∫–∞–∑–∞–Ω'}
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">–í–µ—Å:</span> ${animal.weight || '–ù–µ —É–∫–∞–∑–∞–Ω'} –∫–≥
                            </div>
                            ${animal.health ? `
                                <div class="detail-item">
                                    <span class="detail-label">–ó–¥–æ—Ä–æ–≤—å–µ:</span> ${animal.health}
                                </div>
                            ` : ''}
                            ${animal.personality ? `
                                <div class="detail-item">
                                    <span class="detail-label">–•–∞—Ä–∞–∫—Ç–µ—Ä:</span> ${animal.personality}
                                </div>
                            ` : ''}
                        </div>
                        
                        ${shelter ? `
                            <div class="shelter-info">
                                <strong>–ü—Ä–∏—é—Ç:</strong> ${shelter.name}
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function getAnimalType(type) {
            const normalized = (type || '').toLowerCase().trim();
            const types = {
                'cat': 'üê± –ö–æ—à–∫–∞',
                'dog': 'üê∂ –°–æ–±–∞–∫–∞',
                'other': 'üêæ –î—Ä—É–≥–æ–µ'
            };
            return types[normalized] || types['other'];
        }

        function getGender(gender) {
            const genders = {
                'male': '‚ôÇ –ú—É–∂—Å–∫–æ–π',
                'female': '‚ôÄ –ñ–µ–Ω—Å–∫–∏–π'
            };
            return genders[gender] || gender;
        }

        function showLoading() {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('error').style.display = 'none';
            document.getElementById('animalsContainer').innerHTML = '';
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }

        function showError(message) {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('error').style.display = 'block';
            document.getElementById('error').textContent = message;
        }
    </script>
</body>
</html>