# Функциональность vLadoshkah

## Основные модули

### 1. Аутентификация и авторизация

#### Регистрация и вход
- Регистрация новых пользователей с выбором роли
- Вход в систему через email и пароль
- Обновление JWT токенов (access и refresh)
- Восстановление сессии

#### Роли пользователей
- **user** - обычный пользователь
  - Просмотр животных и приютов
  - Подача заявок на усыновление
  - Добавление в избранное
  - Просмотр своего профиля

- **shelter_admin** - администратор приюта
  - Все права пользователя
  - Управление животными своего приюта
  - Редактирование информации о приюте
  - Просмотр заявок на животных своего приюта

- **admin** - администратор сайта
  - Все права
  - Управление всеми пользователями
  - Управление всеми приютами
  - Управление всеми животными
  - Административная панель

### 2. Управление животными

#### Просмотр и поиск
- Список всех животных с фотографиями
- Фильтрация по параметрам:
  - Тип (собака, кошка, птица, грызун, рыба, рептилия)
  - Пол (мальчик/девочка)
  - Возраст (диапазон)
  - Размер (маленький, средний, большой)
  - Здоровье (здоровый, требует лечения, особые потребности)
- Поиск по имени и описанию
- Просмотр профиля животного с детальной информацией

#### Управление (для админов)
- Создание карточки животного
- Загрузка фотографий (до 5 штук)
- Редактирование информации
- Удаление животного

#### Избранное
- Добавление животных в избранное
- Просмотр списка избранных животных
- Удаление из избранного

### 3. Управление приютами

#### Просмотр
- Список всех приютов с картами
- Фильтрация по району (Москва)
- Рейтинговая система (1-5 звезд)
- Отображение на карте (Leaflet)
- Детальная информация о приюте

#### Управление
- Регистрация нового приюта
- Редактирование информации
- Загрузка фотографий приюта
- Управление рейтингом и отзывами

### 4. Заявки

#### Заявки на усыновление (take)
- Подача заявки на конкретное животное
- Описание заявителя и условий
- Статусы: pending, approved, rejected, cancelled
- Просмотр заявок (для админов приюта)

#### Заявки на отдачу (give)
- Подача заявки на отдачу животного в приют
- Описание животного и причин отдачи
- Прикрепление фотографий
- Обработка заявок администраторами

### 5. Профили пользователей

#### Личный профиль
- Редактирование личной информации
- Загрузка аватара
- Биография пользователя
- Просмотр избранных животных

#### Публичные профили
- Просмотр профилей других пользователей
- Просмотр фотографий пользователя

### 6. Медиа-хранилище

#### Загрузка файлов
- Загрузка фотографий животных
- Загрузка фотографий приютов
- Загрузка аватаров пользователей
- Валидация типов файлов (только изображения)
- Ограничение размера (до 10MB)

#### Хранение
- MinIO объектное хранилище
- S3-совместимый API
- Публичный доступ к файлам
- Метаданные в PostgreSQL

### 7. Уведомления

#### Email уведомления
- Приветственное письмо при регистрации
- Уведомления о заявках
- Настройка через SMTP (опционально)

#### Асинхронная обработка
- Kafka для обработки событий
- Топик: `user-notifications`
- Обработка через consumer

### 8. Кэширование

#### Redis кэш
- Кэширование списков животных
- Кэширование данных приютов
- Кэширование профилей пользователей
- Автоматическая инвалидация при обновлениях
- TTL: 1 час

### 9. Защита и безопасность

#### Rate Limiting
- Глобальный лимит: 100 запросов/минуту
- Лимит для авторизации: 10 запросов/5 минут
- Настраиваемые параметры через env

#### Валидация
- Валидация всех входных данных через Joi
- Проверка типов, форматов, ограничений
- Детальные сообщения об ошибках

## Пользовательские сценарии

### Сценарий 1: Поиск питомца
1. Пользователь открывает страницу поиска
2. Применяет фильтры (тип, возраст, размер)
3. Просматривает карточки животных
4. Открывает профиль понравившегося животного
5. Подает заявку на усыновление

### Сценарий 2: Отдача животного
1. Пользователь заполняет форму отдачи
2. Загружает фотографии животного
3. Выбирает приют
4. Отправляет заявку
5. Администратор приюта обрабатывает заявку

### Сценарий 3: Управление приютом
1. Администратор приюта входит в систему
2. Добавляет новое животное с фотографиями
3. Редактирует информацию о приюте
4. Просматривает заявки на животных
5. Одобряет/отклоняет заявки

### Сценарий 4: Администрирование
1. Администратор сайта входит в панель
2. Управляет пользователями
3. Управляет приютами
4. Модерирует контент
5. Просматривает статистику

## API эндпоинты

### Публичные
- `GET /api/animals` - список животных
- `GET /api/animals/filters` - фильтрация
- `GET /api/animals/:id` - профиль животного
- `GET /api/shelters` - список приютов
- `GET /api/shelters/:id` - профиль приюта
- `GET /api/users` - список пользователей
- `GET /api/users/:id` - профиль пользователя

### Требуют авторизации
- `POST /api/animals` - создание животного
- `POST /api/applications/take` - заявка на усыновление
- `POST /api/applications/give` - заявка на отдачу
- `GET /api/users/me` - свой профиль
- `PUT /api/users/me` - обновление профиля

### Только для админов
- `DELETE /api/animals/:id` - удаление животного
- `PUT /api/shelters/:id` - редактирование приюта
- `DELETE /api/users/:id` - удаление пользователя

## Будущие возможности

- [ ] Система комментариев и отзывов
- [ ] Чат между пользователями и приютами
- [ ] Уведомления в реальном времени (WebSocket)
- [ ] Мобильное приложение
- [ ] Интеграция с социальными сетями
- [ ] Статистика и аналитика
- [ ] Экспорт данных

